name: Development Deployment - EKS 

on:
  push:
    branches:
      - main
    paths-ignore:
      - VERSION

jobs:
  development:
    uses: idasilva/cicd-devops/.github/workflows/development-argocd.yml@main
    with:
      aws_region: "us-east-1"
      aws_role: "arn:aws:iam::560978416398:role/oidc-luffy-services"
      image_name: "560978416398.dkr.ecr.us-east-1.amazonaws.com/luffy-services"      
      eks_namespace: "luffy"
      eks_cluster: "default"
      ref: ${{ github.event.pull_request.merge_commit_sha }}
      argocd_app_name: "luffy-services"
      with_v: true
      prerelease: true
      prerelease_suffix: "rc"
    secrets:
      DEVOPS_TOKEN: ${{ secrets.DEVOPS_TOKEN }}
